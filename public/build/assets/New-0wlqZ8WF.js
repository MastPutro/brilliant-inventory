import{G as k,r as u,j as a}from"./app-Bjn5v1rC.js";import{A as S,T as C,S as B}from"./Icons-CqyroUO_.js";import{A}from"./AuthLayout-CslI81Fu.js";import{T as P}from"./Table-JrttG2Ft.js";import{p as d}from"./formats-toZ2nqUc.js";import{B as p}from"./Button-Cu1muM6q.js";import{C as D}from"./ComboboxSelect-CvbivoLx.js";import{T as n}from"./TextInput-D0DmMJqU.js";import{A as L}from"./Alert-B2CoNMAD.js";import"./active-element-history-DuYwnnKx.js";function R({auth:x,products:h,flash:b}){const{data:f,setData:c,post:g,processing:j,errors:m}=k({date:"",products:[]}),[s,l]=u.useState({id:0,name:"",price:0,stock:0,quantity:1}),[t,o]=u.useState([]),N=()=>{let e=!1;const r=[...t];for(let i=0;i<r.length;i++)r[i].id===s.id&&(r[i].name=s.name,r[i].price=s.price,r[i].quantity=s.quantity,e=!0);e?(o([...r]),c("products",[...r])):(o([...t,s]),c("products",[...t,s]))},y=e=>{const r=[...t];t.forEach((i,T)=>{i.id===e&&r.splice(T,1)}),o(r)},w=e=>{e.preventDefault(),N(),l({id:0,name:"",price:0,stock:0,quantity:1})},q=()=>{g(route("product-out.add"))};return a.jsxs(A,{user:x.user,children:[a.jsx("h2",{className:"font-semibold text-gray-800 text-2xl mb-6 pt-3",children:"Tambah Barang Keluar"}),a.jsx(L,{flash:b}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[a.jsxs("div",{className:"flex w-full flex-col gap-3 bg-white p-4 rounded-md",children:[a.jsxs("div",{className:"w-full",children:[a.jsx("p",{className:"text-xl font-medium mb-2",children:"Informasi Transaksi"}),a.jsx("hr",{className:"border border-gray-200"})]}),a.jsx("div",{className:"w-full",children:a.jsx(n,{label:"Tanggal",value:f.date,type:"date",onChange:e=>c("date",e.target.value),errorMsg:m.date,max:new Date().toISOString().split("T")[0],required:!0,autoFocus:!0})}),a.jsxs("div",{className:"sm:col-span-2 md:col-span-3",children:[a.jsx("p",{className:"text-xl font-medium mb-2",children:"Data Barang"}),a.jsx("hr",{className:"border border-gray-200"})]}),a.jsxs("form",{onSubmit:w,className:"space-y-2",children:[a.jsx("div",{className:"w-full",children:a.jsx(D,{label:"Nama Barang",id:"product",errorMsg:m.products,options:h,value:s,placeholder:"Pilih barang",customValue:!1,onChange:e=>l({...s,id:e==null?void 0:e.id,name:e==null?void 0:e.name,price:e==null?void 0:e.price,stock:e==null?void 0:e.stock}),required:!0})}),a.jsx("div",{className:"w-full",children:a.jsx(n,{label:"Harga",value:d(s.price),min:0,id:"price",onChange:e=>l({...s,price:+e.target.value}),readOnly:!0,disabled:!0})}),a.jsx("div",{className:"w-full mb-3",children:a.jsx(n,{label:"Jumlah",value:s.quantity||"",type:"number",min:1,max:s.stock,id:"quantity",errorMsg:s.stock===0&&s.id>0?"Stok barang habis":"",onChange:e=>l({...s,quantity:+e.target.value}),required:!0})}),a.jsx("div",{className:"w-full",children:a.jsx(p,{className:"w-full",type:"submit",icon:a.jsx(S,{className:"w-5 h-5"}),disabled:s.stock===0,children:"Tambah"})})]})]}),a.jsxs("div",{className:"flex flex-col bg-white p-4 rounded-md md:col-span-2",children:[a.jsxs("div",{className:"w-full mb-2",children:[a.jsx("p",{className:"text-xl font-medium mb-2",children:"Daftar Barang Keluar"}),a.jsx("hr",{className:"border border-gray-200"})]}),a.jsx("div",{className:"w-full",children:a.jsx(P,{header:[{label:"Nama Barang"},{label:"Jumlah"},{label:"Harga"},{label:"Total Harga"},{label:""}],body:t.length?[...t.map(e=>[e.name,e.quantity,d(e.price),d(e.price*e.quantity),a.jsx("button",{className:"text-red-500",onClick:()=>y(e.id),children:a.jsx(C,{className:"w-5 h-5"})})]),["","","Total",`${d(t.reduce((e,r)=>e+r.price*+r.quantity,0))}`,""]]:[]})}),a.jsx("div",{children:t.length>0&&a.jsx(p,{onClick:q,icon:a.jsx(B,{className:"w-5 h-5"}),disabled:j,children:"Simpan"})})]})]})]})}export{R as default};
